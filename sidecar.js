(function(b,a,c){a.dtAccountDrawer=function(){this.elems={};this.options={};this.isOpen=false;this.forceReload=false;this.ns="dt-drawer";this.fragment="";this.fragmentClass="";this.iframe_src=document.location.protocol+"//www.dtelepathy.com/dt-account-sidebar";this.iframe_url="";this.page_url=a.location.href;this.__construct()};a.dtAccountDrawer.prototype.__construct=function(){var f=this;this.options.openDelay=250;this.elems.html=b("html");this.elems.body=b("body");this.elems.head=b("head");this.elems.iframe=false;var d=document.getElementsByTagName("script");var j=new RegExp("sidecar(.dev)?.js.*side=(left|right)");for(var i in d){var e=d[i];if(e.src&&e.src.match(j)){var h=e.src.match(j)[e.src.match(j).length-1];this.elems.body.addClass("sidecar-"+h)}}this.options.android=false;var g=navigator.userAgent.toLowerCase();if(g.indexOf("android")>-1){this.options.android=true;this.elems.body.addClass("noDrawerTransition");this.elems.body.addClass("noFixedPosition")}if(g.match(/android|ipad|iphone/)){this.elems.body.removeClass("sidecar-left")}this._addDrawer();this._addStylesheet();this._bindEvents()};a.dtAccountDrawer.prototype._addDrawer=function(){this.elems.drawer=b('<div id="'+this.ns+'"></div>').appendTo(this.elems.body);this.elems.drawerInner=b('<div class="'+this.ns+'-inner"></div>').appendTo(this.elems.drawer);this.elems.drawerInner.css({height:b(document).height()});this._addOpenButton();this._addCloseButton()};a.dtAccountDrawer.prototype._addOpenButton=function(){this.elems.open=b('<a id="'+this.ns+'-open" class="icon-bars" href="#open"><div class="horiz bar"></div><div class="vert bar"></div><div id="bowlG"><div id="bowl_ringG"><div class="ball_holderG"><div class="ballG"></div></div></div></div></a>').appendTo(this.elems.body)};a.dtAccountDrawer.prototype._addCloseButton=function(){this.elems.close=b('<a id="'+this.ns+'-close" href="#close"><div class="horiz bar"></div></a>').appendTo(this.elems.body)};a.dtAccountDrawer.prototype._addIFrame=function(){var d=this;d.elems.iframe=b('<iframe id="'+this.ns+'-iframe" style="overflow:hidden;height:100%;width:100%" height="100%" width="100%" scrolling="no" frameborder="0" src="'+d.iframe_url+'"></iframe>').appendTo(this.elems.drawerInner);d.elems.open.addClass("spinner");if(this.options.android){d.elems.iframe.addClass("loaded");d.elems.open.removeClass("spinner");d.elems.open.removeClass(d.fragmentClass);d.elems.body.addClass("openDrawer")}else{d.elems.iframe.ready(function(e){setTimeout(function(){d.elems.iframe.addClass("loaded");d.elems.open.removeClass("spinner");d.elems.open.removeClass(d.fragmentClass);d.elems.body.addClass("openDrawer")},d.options.openDelay)})}};a.dtAccountDrawer.prototype._removeIFrame=function(){if(typeof(this.elems.iframe)=="object"){this.elems.iframe.remove()}this.elems.iframe=false};a.dtAccountDrawer.prototype._addStylesheet=function(){this.elems.head.append('<link type="text/css" rel="stylesheet" href="'+document.location.protocol+'//s3.amazonaws.com/assets-dtlabs/sidecar/sidecar.css?v=201211161414">')};a.dtAccountDrawer.prototype._bindEvents=function(){var d=this;this.elems.open.on("click",function(e){e.preventDefault();d.open()});this.elems.close.on("click",function(e){e.preventDefault();d.close()})};a.dtAccountDrawer.prototype.close=function(){this.elems.body.removeClass("openDrawer")};a.dtAccountDrawer.prototype.open=function(){var e=this;var f="_dtsrc="+e.page_url;if(e.elems.open.hasClass("action-signup")){e.fragment="#!signup|"+f;e.fragmentClass="action-signup";e.forceReload=true}else{if(e.elems.open.hasClass("action-login")){e.fragment="#!login|"+f;e.fragmentClass="action-login";e.forceReload=true}else{e.fragment="#!"+f}}e.iframe_url=e.iframe_src+e.fragment;if(e.forceReload){e._removeIFrame();e.forceReload=false}if(e.elems.iframe===false){e._addIFrame()}else{e.elems.body.addClass("openDrawer")}var g=e.elems.open[0].className.match(/icon-([\w\d\-_+])/);if(g){var d=g[1];if(typeof(_gaq)!="undefined"){_gaq.push(["_trackEvent","SideCar","Open",d])}else{if(typeof(pageTracker)!="undefined"){pageTracker._trackEvent("SideCar","Open",d)}}}};b(function(){b.data(document.body,"dtAccountDrawer",new dtAccountDrawer())})})(jQuery,window,null);